{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Uncategorized",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "",
            "description": "",
            "joint": {
                "cells": [
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Set_last_automated_action 2, Set_last_automated_action 1, PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01, Set_last_automated_action 3, KTB Triage Playbook for Generic Label, Set_last_automated_action 4",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "1a118922-7301-4aaa-865c-f12f819569da",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 823,
                        "line_start": 810,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 32,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2500,
                            "y": 500
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 54
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "91fc30ed-864d-4b09-8536-f6ed82389aca",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0fc0a6fd-312b-4979-8370-fc70844b2d2b",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0ffc1921-ad65-4636-a943-b2a7a6e0fe59",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 344
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "30a7c3fb-7145-4ba9-9af4-c976b14cf431",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0ffc1921-ad65-4636-a943-b2a7a6e0fe59",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "3eefe03d-7e82-4958-8b2b-ad6d76659c46",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 346
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "61a84a13-955e-4cd8-8a46-5215515857c1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "3eefe03d-7e82-4958-8b2b-ad6d76659c46",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4783dfd1-7aab-4a4d-a214-76638cf74e7d",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 349
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1df1f2b5-e9f6-4314-8ddd-d7b65e7bcd1e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b9f367bd-d66d-4250-85dd-67951a6dd65f",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6df0cb5a-092d-4a5e-979a-772ad69b0f5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 353
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "80f43bbd-b764-4349-8218-61914767b4be",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0a5b8d3b-a40b-4a6c-9aa4-dadaf1cb976c",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6df0cb5a-092d-4a5e-979a-772ad69b0f5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 354
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'decision_5' block\n    decision_5(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0fc0a6fd-312b-4979-8370-fc70844b2d2b",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 15,
                        "line_start": 7,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -100,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 357
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "73543c0c-77d0-4542-9480-39257d1268c5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "06f07614-3521-4bd8-b841-5655d33ff3d6",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c26f671b-315e-4b67-b42d-7a333cfb0085",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 371
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "eda1148f-1ccc-4427-b559-14579d887d7a",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d40674a8-f604-4eeb-877c-41b908060a59",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "cbc0cef9-e95b-477c-8c48-3d98b7f7e01c",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 375
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f0ca9a8c-60c2-4f2f-9b04-9b7af03ab724",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cbc0cef9-e95b-477c-8c48-3d98b7f7e01c",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4b99579e-6f4b-48c0-b8f1-e3b0a3af8401",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 386
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6b6e6bc7-bd72-4b9f-91a2-8df3eb8681d4",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cbc0cef9-e95b-477c-8c48-3d98b7f7e01c",
                            "port": "out-3",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(3) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "65657e12-c948-41a3-b728-f7df3b61de52",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 389
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a92c9eda-46a4-4c23-9190-859043bc03bc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "65657e12-c948-41a3-b728-f7df3b61de52",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ceb64779-4cb5-4d70-90a9-13652d1da1a5",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 398
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "3ec746de-8185-4c64-805d-cc361373f722",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4b99579e-6f4b-48c0-b8f1-e3b0a3af8401",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c00f0fb7-26aa-4785-8148-60c0e0dda9ca",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 400
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2af30451-d4e5-495a-b493-35b4c8455ac4",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c00f0fb7-26aa-4785-8148-60c0e0dda9ca",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b71b40a3-55c3-450e-91f4-6d942f06f8c6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 403
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "e68fc6bb-0121-4ccd-b929-31b4ea645d02",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ceb64779-4cb5-4d70-90a9-13652d1da1a5",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "74917f6a-c2fc-43f0-8eb5-a5e7dddc2ee6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 407
                    },
                    {
                        ".scmName/text": "local",
                        "Container_id-0": "container:id",
                        "a_status-1": "Request for Containment",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "Set_last_automated_acti..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_Set_last_automated_action_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_Set_last_automated_action_2() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n    literal_values_0 = [\n        [\n            \"Request for Containment\",\n        ],\n    ]\n\n    parameters = []\n\n    literal_values_0_0 = [item[0] for item in literal_values_0]\n    container_property_0_0 = [item[0] for item in container_property_0]\n\n    parameters.append({\n        'a_status': literal_values_0_0,\n        'Container_id': container_property_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/Set_last_automated_action\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/Set_last_automated_action', parameters=parameters, name='cf_local_Set_last_automated_action_2')\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/Set_last_automated_action",
                        "cfInputs": {
                            "Container_id": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            },
                            "a_status": {
                                "collectionType": "literal_values",
                                "dataPath": "Request for Containment",
                                "paramName": "literal_values_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 26,
                        "customFunction": "local/Set_last_automated_action",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "74917f6a-c2fc-43f0-8eb5-a5e7dddc2ee6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 508,
                        "line_start": 470,
                        "message": "Configuring now",
                        "name": "Set_last_automated_action",
                        "notes": "",
                        "number": 2,
                        "order": 19,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2080,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_Set_last_automated_action_2",
                        "selectedCustomFunction": {
                            "description": "set custom field last_automated_action",
                            "draftMode": false,
                            "id": 111,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [
                                        "phantom container id"
                                    ],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 205,
                                    "input_type": "list",
                                    "name": "Container_id",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 206,
                                    "input_type": "list",
                                    "name": "a_status",
                                    "placeholder": ""
                                }
                            ],
                            "name": "Set_last_automated_action",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "data_path": "res",
                                    "description": "",
                                    "id": 97
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-VIRTUSTOTAL-THREASTREAM-01",
                                        "draft_mode": false,
                                        "id": 3620,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-VIRTUSTOTAL-THREASTREAM-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "draft_mode": false,
                                        "id": 3611,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "draft_mode": false,
                                        "id": 3632,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB -Triage Playbook for Attivo Label",
                                        "draft_mode": false,
                                        "id": 3167,
                                        "name": "KTB -Triage Playbook for Attivo Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/test update filed",
                                        "draft_mode": false,
                                        "id": 2171,
                                        "name": "test update filed",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/01-Contain-Approve-Playbook",
                                        "draft_mode": false,
                                        "id": 3148,
                                        "name": "01-Contain-Approve-Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/010-Triage playbook",
                                        "draft_mode": false,
                                        "id": 3358,
                                        "name": "010-Triage playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/022-Master Malware_backup",
                                        "draft_mode": false,
                                        "id": 3359,
                                        "name": "022-Master Malware_backup",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Triage Playbook",
                                        "draft_mode": false,
                                        "id": 3496,
                                        "name": "KTB Triage Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Approve Playbook",
                                        "draft_mode": false,
                                        "id": 3367,
                                        "name": "KTB Approve Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-DATA-01",
                                        "draft_mode": false,
                                        "id": 3663,
                                        "name": "PLAYBOOK-INVESTIGATE-DATA-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbook",
                                        "draft_mode": false,
                                        "id": 3774,
                                        "name": "KTB Master Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "draft_mode": false,
                                        "id": 3684,
                                        "name": "PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTC-CONTAIN-URL",
                                        "draft_mode": false,
                                        "id": 3775,
                                        "name": "KTC-CONTAIN-URL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/02-Master Malware",
                                        "draft_mode": false,
                                        "id": 3435,
                                        "name": "02-Master Malware",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "warn",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 408
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "8aea2f36-38b7-4367-b8e3-ea2bcb93e9ba",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "74917f6a-c2fc-43f0-8eb5-a5e7dddc2ee6",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 409
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "21ebfafc-c13d-4484-a35b-1d36b51e884d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b71b40a3-55c3-450e-91f4-6d942f06f8c6",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 411
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format prompt decline"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_prompt_decline(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_prompt_decline() called')\n    \n    template = \"\"\"The Request URL {0} is malicious, but approver decide to not contain.\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_1:condition_1:artifact:*.cef.requestURL\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_prompt_decline\", separator=\", \")\n\n    set_status_add_note_3(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format prompt decline",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4b99579e-6f4b-48c0-b8f1-e3b0a3af8401",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 384,
                        "line_start": 368,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 11,
                        "order": 14,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_1:artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1360,
                            "y": 600
                        },
                        "previous_function": "",
                        "previous_name": "format_prompt_decline",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "warn",
                        "template": "The Request URL {0} is malicious, but approver decide to not contain.",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 414
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1ce0bd0f-7bb7-4eab-a984-0116d754d467",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d4a878a7-94dd-4e9d-8325-8ad69f5f836b",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "46e3127d-223c-41a6-9d1e-9ab4e3c48ff5",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 436
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "17d718c2-e730-4cda-872a-374811fe8aa1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "46e3127d-223c-41a6-9d1e-9ab4e3c48ff5",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "bec3ab5d-fd75-4483-827b-86ca380d8cb7",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 444
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "49bb14d4-e537-49d2-9aec-921c6c12c70d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "bec3ab5d-fd75-4483-827b-86ca380d8cb7",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 446
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format prompt timeout"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_prompt_timeout(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_prompt_timeout() called')\n    \n    template = \"\"\"The Request URL {0} is malicious, but no response from approver.\n\nPlease further analyse.\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_1:condition_1:artifact:*.cef.requestURL\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_prompt_timeout\", separator=\", \")\n\n    set_status_add_note_2(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format prompt timeout",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "65657e12-c948-41a3-b728-f7df3b61de52",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 402,
                        "line_start": 384,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 12,
                        "order": 15,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_1:artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1360,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "format_prompt_timeout",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "warn",
                        "template": "The Request URL {0} is malicious, but no response from approver.\n\nPlease further analyse.",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 486
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "extract domain"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def extract_domain(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extract_domain() called')\n    \n    container_data = phantom.collect2(container=container, datapath=['artifact:*.id', 'artifact:*.cef.requestURL', 'artifact:*.id'])\n    container_item_0 = [item[0] for item in container_data]\n    container_item_1 = [item[1] for item in container_data]\n\n    extract_domain__destinationDomain = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    \n    requestDomain = []\n    destinationDomain = []\n    #phantom.debug(container_data)\n    #phantom.debug(container_item_0)\n    #phantom.debug(container_item_1)\n    for artifact in container_data:\n        artifact_id = artifact[0]\n        requestURL = artifact[1]\n        phantom.debug(requestURL)\n        requestDomain.append([artifact_id,requestURL.split(\"//\")[1].split(\"/\")[0]])\n    \n    phantom.debug(requestDomain)\n    parameters = []\n    \n    for item in requestDomain:\n        parameters.append({\n        'artifact_id': item[0],\n        'cef_json': {\"destinationDnsDomain\" : item[1]},\n        })\n        destinationDomain.append(item[1])\n    \n    phantom.debug(destinationDomain)\n    phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_artifact_destinationDnsDomain\")\n    extract_domain__destinationDomain = destinationDomain\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='extract_domain:destinationDomain', value=json.dumps(extract_domain__destinationDomain))\n    join_update_proxy_url(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 12,
                        "custom_callback": "",
                        "custom_code": "def extract_domain(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extract_domain() called')\n    \n    container_data = phantom.collect2(container=container, datapath=['artifact:*.id', 'artifact:*.cef.requestURL', 'artifact:*.id'])\n    container_item_0 = [item[0] for item in container_data]\n    container_item_1 = [item[1] for item in container_data]\n\n    extract_domain__destinationDomain = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    \n    requestDomain = []\n    destinationDomain = []\n    #phantom.debug(container_data)\n    #phantom.debug(container_item_0)\n    #phantom.debug(container_item_1)\n    for artifact in container_data:\n        artifact_id = artifact[0]\n        requestURL = artifact[1]\n        phantom.debug(requestURL)\n        requestDomain.append([artifact_id,requestURL.split(\"//\")[1].split(\"/\")[0]])\n    \n    phantom.debug(requestDomain)\n    parameters = []\n    \n    for item in requestDomain:\n        parameters.append({\n        'artifact_id': item[0],\n        'cef_json': {\"destinationDnsDomain\" : item[1]},\n        })\n        destinationDomain.append(item[1])\n    \n    phantom.debug(destinationDomain)\n    phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_artifact_destinationDnsDomain\")\n    extract_domain__destinationDomain = destinationDomain\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='extract_domain:destinationDomain', value=json.dumps(extract_domain__destinationDomain))\n    decision_4(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "extract domain",
                        "description": "",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "3eefe03d-7e82-4958-8b2b-ad6d76659c46",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "legacy": true,
                        "line_end": 161,
                        "line_start": 107,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "",
                        "number": 6,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "destinationDomain"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.id"
                            },
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 260,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "extract_domain",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    # Write your custom code here...\n    \n    requestDomain = []\n    destinationDomain = []\n    #phantom.debug(container_data)\n    #phantom.debug(container_item_0)\n    #phantom.debug(container_item_1)\n    for artifact in container_data:\n        artifact_id = artifact[0]\n        requestURL = artifact[1]\n        phantom.debug(requestURL)\n        requestDomain.append([artifact_id,requestURL.split(\"//\")[1].split(\"/\")[0]])\n    \n    phantom.debug(requestDomain)\n    parameters = []\n    \n    for item in requestDomain:\n        parameters.append({\n        'artifact_id': item[0],\n        'cef_json': {\"destinationDnsDomain\" : item[1]},\n        })\n        destinationDomain.append(item[1])\n    \n    phantom.debug(destinationDomain)\n    phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_artifact_destinationDnsDomain\")\n    extract_domain__destinationDomain = destinationDomain\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################\n    ################################################################################",
                        "warn": false,
                        "z": 487
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".playbook": {
                                "text": "PLAYBOOK-ENRICH-INDI..."
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "Playbook"
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2() called')\n    \n    # call playbook \"local/PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01\", returns the playbook_run_id\n    playbook_run_id = phantom.playbook(playbook=\"local/PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01\", container=container, name=\"playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2\", callback=join_set_status_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "connected_to_start": true,
                        "connection_name": "KTB Triage Playbook for Generic Label",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b9f367bd-d66d-4250-85dd-67951a6dd65f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 169,
                        "line_start": 161,
                        "message": "Configuring now",
                        "name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                        "notes": "",
                        "number": 2,
                        "order": 7,
                        "outPorts": [
                            "out"
                        ],
                        "playbook": "local/PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1160,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2",
                        "scmName": "local",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "callplaybook",
                        "status": "",
                        "title": "Playbook",
                        "type": "coa.CallPlaybook",
                        "warn": false,
                        "z": 496
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "note URL in no contain li..."
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def note_URL_in_no_contain_list(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('note_URL_in_no_contain_list() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_URL_in_no_contain_list')\n\n    note_title = \"\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "format_URL_in_no_contain_list:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "note URL in no contain list",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "bec3ab5d-fd75-4483-827b-86ca380d8cb7",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 540,
                        "line_start": 528,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "",
                        "number": 4,
                        "order": 21,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1040,
                            "y": 720
                        },
                        "previous_function": "",
                        "previous_name": "note_URL_in_no_contain_list",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 507
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0974ec08-118e-477d-a750-2b455dc44782",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d4a878a7-94dd-4e9d-8325-8ad69f5f836b",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "f59cbd29-9acc-452b-b5be-211b6047e04e",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 512
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format URL in no contain..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_URL_in_no_contain_list(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_URL_in_no_contain_list() called')\n    \n    template = \"\"\"Follow URL found malicious and in 'NO CONTAIL URL' list\n\n%%\n{0}\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_1:condition_2:artifact:*.cef.requestURL\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_URL_in_no_contain_list\", separator=\", \")\n\n    note_URL_in_no_contain_list(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format URL in no contain list",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "46e3127d-223c-41a6-9d1e-9ab4e3c48ff5",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 528,
                        "line_start": 508,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 13,
                        "order": 20,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_2:artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 760,
                            "y": 720
                        },
                        "previous_function": "",
                        "previous_name": "format_URL_in_no_contain_list",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Follow URL found malicious and in 'NO CONTAIL URL' list\n\n%%\n{0}\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 518
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "update proxy url"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def update_proxy_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('update_proxy_url() called')\n    \n    container_data = phantom.collect2(container=container, datapath=['artifact:*.id', 'artifact:*.cef.requestURL', 'artifact:*.id'])\n    container_item_0 = [item[0] for item in container_data]\n    container_item_1 = [item[1] for item in container_data]\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    test_url = container_item_1[0]\n    #\n    if test_url.split(\":\")[0] != \"http\" and test_url.split(\":\",1)[0] != \"https\":\n        test_url = \"http:\" + test_url.split(\":\",1)[1]\n    \n        parameters = []\n        cef_json = {\"requestURL\" : test_url }\n                    \n        # build parameters list for 'update_mac' call\n        parameters.append({\n        'artifact_id': container_item_0[0],\n        'name': \"\",\n        'label': \"\",\n        'severity': \"\",\n        'cef_json': cef_json,\n        'cef_types_json': \"\",\n        'tags': \"\",\n        'overwrite': \"\",\n        'artifact_json': \"\",\n        })\n        \n        phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_proxy_url\")\n\n    #####################################\n\n    test_url = container_item_0[0]\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n    playbook_local_KTB_Triage_Playbook_for_Generic_Label_1(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "customCodeEndLineOffset": 5,
                        "customCodeStartLine": 10,
                        "custom_callback": "",
                        "custom_code": "def update_proxy_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('update_proxy_url() called')\n    \n    container_data = phantom.collect2(container=container, datapath=['artifact:*.id', 'artifact:*.cef.requestURL', 'artifact:*.id'])\n    container_item_0 = [item[0] for item in container_data]\n    container_item_1 = [item[1] for item in container_data]\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    test_url = container_item_1[0]\n    #\n    if test_url.split(\":\")[0] != \"http\" and test_url.split(\":\",1)[0] != \"https\":\n        test_url = \"http:\" + test_url.split(\":\",1)[1]\n    \n        parameters = []\n        cef_json = {\"requestURL\" : test_url }\n                    \n        # build parameters list for 'update_mac' call\n        parameters.append({\n        'artifact_id': container_item_0[0],\n        'name': \"\",\n        'label': \"\",\n        'severity': \"\",\n        'cef_json': cef_json,\n        'cef_types_json': \"\",\n        'tags': \"\",\n        'overwrite': \"\",\n        'artifact_json': \"\",\n        })\n        \n        phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_proxy_url\")\n\n    #####################################\n\n    test_url = container_item_0[0]\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n    set_status_1(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "update proxy url",
                        "description": "",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4783dfd1-7aab-4a4d-a214-76638cf74e7d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_update_proxy_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_update_proxy_url() called')\n\n    # no callbacks to check, call connected block \"update_proxy_url\"\n    phantom.save_run_data(key='join_update_proxy_url_called', value='update_proxy_url', auto=True)\n\n    update_proxy_url(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 97,
                        "legacy": true,
                        "line_end": 107,
                        "line_start": 50,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "",
                        "number": 5,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": ""
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.id"
                            },
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 500,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "update_proxy_url",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    # Write your custom code here...\n\n    test_url = container_item_1[0]\n    #\n    if test_url.split(\":\")[0] != \"http\" and test_url.split(\":\",1)[0] != \"https\":\n        test_url = \"http:\" + test_url.split(\":\",1)[1]\n    \n        parameters = []\n        cef_json = {\"requestURL\" : test_url }\n                    \n        # build parameters list for 'update_mac' call\n        parameters.append({\n        'artifact_id': container_item_0[0],\n        'name': \"\",\n        'label': \"\",\n        'severity': \"\",\n        'cef_json': cef_json,\n        'cef_types_json': \"\",\n        'tags': \"\",\n        'overwrite': \"\",\n        'artifact_json': \"\",\n        })\n        \n        phantom.act(action=\"update artifact\", parameters=parameters, assets=['phantom asset'], name=\"update_proxy_url\")\n\n    #####################################\n\n    test_url = container_item_0[0]\n\n",
                        "warn": false,
                        "z": 524
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0349f574-e1f5-4c8e-9f6c-a313671e7031",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4783dfd1-7aab-4a4d-a214-76638cf74e7d",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "32eb334e-5b60-4d16-ae13-ecc5492d6dd3",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 525
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "301c2854-9e8b-4919-aef5-a366b7b50a3b",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6df0cb5a-092d-4a5e-979a-772ad69b0f5f",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d4a878a7-94dd-4e9d-8325-8ad69f5f836b",
                            "port": "in",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 526
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "428055ee-0d34-40a4-a5b0-dcbcc388df55",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c26f671b-315e-4b67-b42d-7a333cfb0085",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d40674a8-f604-4eeb-877c-41b908060a59",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 527
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f90ac34d-75b1-4e02-b91e-be1bbfb9d52a",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "23fc3590-7495-4c41-8383-b086c73afe1f",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "e8d0ae4a-dd42-48e2-9947-284ee05d781e",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 536
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7ee54d2b-3be1-4145-84c3-9c5660d4182f",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "e8d0ae4a-dd42-48e2-9947-284ee05d781e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "24a220a0-e59d-48d9-b2e3-11bac0819086",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 538
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5807f14b-bd50-4ab0-8a10-1cc907b84448",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "24a220a0-e59d-48d9-b2e3-11bac0819086",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 540
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b1a19bc5-70e4-48bf-9736-991f556646fa",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "23fc3590-7495-4c41-8383-b086c73afe1f",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ecfa8a29-8c49-4282-b971-7c6d80cddc63",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 547
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2bede017-a9ee-42c9-b155-f6bdc2af6b56",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ecfa8a29-8c49-4282-b971-7c6d80cddc63",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "24a220a0-e59d-48d9-b2e3-11bac0819086",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 548
                    },
                    {
                        ".scmName/text": "local",
                        "Container_id-0": "container:id",
                        "a_status-1": "Enriched",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "Set_last_automated_acti..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_Set_last_automated_action_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_Set_last_automated_action_3() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n    literal_values_0 = [\n        [\n            \"Enriched\",\n        ],\n    ]\n\n    parameters = []\n\n    literal_values_0_0 = [item[0] for item in literal_values_0]\n    container_property_0_0 = [item[0] for item in container_property_0]\n\n    parameters.append({\n        'a_status': literal_values_0_0,\n        'Container_id': container_property_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/Set_last_automated_action\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/Set_last_automated_action', parameters=parameters, name='cf_local_Set_last_automated_action_3')\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/Set_last_automated_action",
                        "cfInputs": {
                            "Container_id": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            },
                            "a_status": {
                                "collectionType": "literal_values",
                                "dataPath": "Enriched",
                                "paramName": "literal_values_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01, ADD_IOC_Containment_LIST",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 26,
                        "customFunction": "local/Set_last_automated_action",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "24a220a0-e59d-48d9-b2e3-11bac0819086",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_cf_local_Set_last_automated_action_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_cf_local_Set_last_automated_action_3() called')\n\n    # check if all connected incoming playbooks, actions, or custom functions are done i.e. have succeeded or failed\n    if phantom.completed(playbook_names=['playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1', 'playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2'], custom_function_names=['cf_local_ADD_IOC_Containment_LIST_1']):\n        \n        # call connected block \"cf_local_Set_last_automated_action_3\"\n        cf_local_Set_last_automated_action_3(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 645,
                        "line_end": 656,
                        "line_start": 607,
                        "message": "Configuring now",
                        "name": "Set_last_automated_action",
                        "notes": "",
                        "number": 3,
                        "order": 25,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1900,
                            "y": 880
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_Set_last_automated_action_3",
                        "selectedCustomFunction": {
                            "description": "set custom field last_automated_action",
                            "draftMode": false,
                            "id": 111,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [
                                        "phantom container id"
                                    ],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 205,
                                    "input_type": "list",
                                    "name": "Container_id",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 206,
                                    "input_type": "list",
                                    "name": "a_status",
                                    "placeholder": ""
                                }
                            ],
                            "name": "Set_last_automated_action",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "data_path": "res",
                                    "description": "",
                                    "id": 97
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/test update filed",
                                        "draft_mode": false,
                                        "id": 2171,
                                        "name": "test update filed",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/010-Triage playbook",
                                        "draft_mode": false,
                                        "id": 3358,
                                        "name": "010-Triage playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/022-Master Malware_backup",
                                        "draft_mode": false,
                                        "id": 3359,
                                        "name": "022-Master Malware_backup",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/KTB -Triage Playbook for Events Label",
                                        "draft_mode": false,
                                        "id": 3836,
                                        "name": "KTB -Triage Playbook for Events Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB -Triage Playbook for Attivo Label",
                                        "draft_mode": false,
                                        "id": 3837,
                                        "name": "KTB -Triage Playbook for Attivo Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Triage Playbook",
                                        "draft_mode": false,
                                        "id": 3496,
                                        "name": "KTB Triage Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-ENRICH-EMAIL",
                                        "draft_mode": false,
                                        "id": 4016,
                                        "name": "KTB-ENRICH-EMAIL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-EMAIL-01",
                                        "draft_mode": false,
                                        "id": 4017,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-EMAIL-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-PROXY-01",
                                        "draft_mode": false,
                                        "id": 4019,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-PROXY-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/01-Contain-Approve-Playbook",
                                        "draft_mode": false,
                                        "id": 4031,
                                        "name": "01-Contain-Approve-Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "draft_mode": false,
                                        "id": 4032,
                                        "name": "PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Approve Playbook",
                                        "draft_mode": false,
                                        "id": 4033,
                                        "name": "KTB Approve Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                                        "draft_mode": false,
                                        "id": 3620,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-CONTAIN-URL",
                                        "draft_mode": false,
                                        "id": 4037,
                                        "name": "KTB-CONTAIN-URL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbook",
                                        "draft_mode": false,
                                        "id": 3774,
                                        "name": "KTB Master Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-DATA-01",
                                        "draft_mode": false,
                                        "id": 4038,
                                        "name": "PLAYBOOK-INVESTIGATE-DATA-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Malware Contain Playbook",
                                        "draft_mode": false,
                                        "id": 4050,
                                        "name": "KTB Malware Contain Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "draft_mode": false,
                                        "id": 4052,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "draft_mode": false,
                                        "id": 4053,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/02-Master Malware",
                                        "draft_mode": false,
                                        "id": 3435,
                                        "name": "02-Master Malware",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 549
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format 14"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_14(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_14() called')\n    \n    template = \"\"\"This is an automated message to inform you the IOC detected in incident. (No automatic containment is executed by the playbook). \n\n====================\n[Case ID]: {0}\n[Case Name]: {1}\n[IOC to contain]: {2}\n====================\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"container:id\",\n        \"container:name\",\n        \"transform_url_to_send_email:custom_function:transformURL\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_14\", separator=\", \")\n\n    add_note_5(container=container)\n    cf_local_ADD_IOC_Containment_LIST_1(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "23fc3590-7495-4c41-8383-b086c73afe1f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 594,
                        "line_start": 569,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 14,
                        "order": 23,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "container:id"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "container:name"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "transform_url_to_send_email:custom_function:transformURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 760,
                            "y": 880
                        },
                        "previous_function": "",
                        "previous_name": "format_14",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "This is an automated message to inform you the IOC detected in incident. (No automatic containment is executed by the playbook). \n\n====================\n[Case ID]: {0}\n[Case Name]: {1}\n[IOC to contain]: {2}\n====================",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 552
                    },
                    {
                        ".scmName/text": "local",
                        "Container_id-2": "container:id",
                        "IOC_Type-1": "url",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "ADD_IOC_Containment_L..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_ADD_IOC_Containment_LIST_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_ADD_IOC_Containment_LIST_1() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n    legacy_custom_function_result_0 = [\n        [\n            json.loads(phantom.get_run_data(key=\"transform_url_to_send_email:transformURL\")),\n        ],\n    ]\n    literal_values_0 = [\n        [\n            \"url\",\n        ],\n    ]\n\n    parameters = []\n\n    for item0 in literal_values_0:\n        for item1 in legacy_custom_function_result_0:\n            for item2 in container_property_0:\n                parameters.append({\n                    'IOC_Type': item0[0],\n                    'input_IOC': item1[0],\n                    'Container_id': item2[0],\n                })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/ADD_IOC_Containment_LIST\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/ADD_IOC_Containment_LIST', parameters=parameters, name='cf_local_ADD_IOC_Containment_LIST_1', callback=join_cf_local_Set_last_automated_action_3)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/ADD_IOC_Containment_LIST",
                        "cfInputs": {
                            "Container_id": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "item2[0]",
                                "type": "item"
                            },
                            "IOC_Type": {
                                "collectionType": "literal_values",
                                "dataPath": "url",
                                "paramName": "item0[0]",
                                "type": "item"
                            },
                            "input_IOC": {
                                "collectionType": "legacy_custom_function_result",
                                "dataPath": "transform_url_to_send_email:custom_function:transformURL",
                                "paramName": "item1[0]",
                                "type": "item"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 32,
                        "customFunction": "local/ADD_IOC_Containment_LIST",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ecfa8a29-8c49-4282-b971-7c6d80cddc63",
                        "inPorts": [
                            "in"
                        ],
                        "input_IOC-0": "transform_url_to_send_email:custom_function:transformURL",
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 700,
                        "line_start": 656,
                        "message": "Configuring now",
                        "name": "ADD_IOC_Containment_LIST",
                        "notes": "",
                        "number": 1,
                        "order": 26,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1040,
                            "y": 1000
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_ADD_IOC_Containment_LIST_1",
                        "selectedCustomFunction": {
                            "description": "",
                            "draftMode": false,
                            "id": 147,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "ADD_IOC_Containment_LIST",
                                    "contains_type": [],
                                    "custom_function": 147,
                                    "description": "",
                                    "id": 299,
                                    "input_type": "item",
                                    "name": "input_IOC",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "ADD_IOC_Containment_LIST",
                                    "contains_type": [],
                                    "custom_function": 147,
                                    "description": "",
                                    "id": 300,
                                    "input_type": "item",
                                    "name": "IOC_Type",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "ADD_IOC_Containment_LIST",
                                    "contains_type": [],
                                    "custom_function": 147,
                                    "description": "",
                                    "id": 301,
                                    "input_type": "item",
                                    "name": "Container_id",
                                    "placeholder": ""
                                }
                            ],
                            "name": "ADD_IOC_Containment_LIST",
                            "outputs": [],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": []
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 553
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".playbook": {
                                "text": "PLAYBOOK-ENRICH-INDI..."
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "Playbook"
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1() called')\n    \n    # call playbook \"local/PLAYBOOK-ENRICH-INDICATOR-ALL-01\", returns the playbook_run_id\n    playbook_run_id = phantom.playbook(playbook=\"local/PLAYBOOK-ENRICH-INDICATOR-ALL-01\", container=container, name=\"playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1\", callback=join_set_status_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 23,
                        "callsback": true,
                        "connected_to_start": true,
                        "connection_name": "KTB Triage Playbook for Generic Label",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0a5b8d3b-a40b-4a6c-9aa4-dadaf1cb976c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 23,
                        "line_start": 15,
                        "message": "Configuring now",
                        "name": "PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "notes": "",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out"
                        ],
                        "playbook": "local/PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1160,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1",
                        "scmName": "local",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "callplaybook",
                        "status": "",
                        "title": "Playbook",
                        "type": "coa.CallPlaybook",
                        "warn": false,
                        "z": 555
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "3ee23415-ff6a-4ca1-81ce-f232d918f624",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "32eb334e-5b60-4d16-ae13-ecc5492d6dd3",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6ac9c426-1a96-413d-b960-cd41dd94c857",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 557
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "set status, add note",
                        "attrs": {
                            ".api": {
                                "text": "set status, add note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def set_status_add_note_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('set_status_add_note_3() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_prompt_decline')\n\n    phantom.set_status(container=container, status=\"In progress\")\n\n    note_title = \"\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n    cf_local_Set_last_automated_action_1(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "key": "set-status",
                                "setStatusStatus": "In progress",
                                "setStatusStatus_display": "In progress"
                            },
                            {
                                "addNoteContent": "format_prompt_decline:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c00f0fb7-26aa-4785-8148-60c0e0dda9ca",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 432,
                        "line_start": 417,
                        "message": "Configuring now",
                        "name": "set status, add note",
                        "notes": "",
                        "number": 3,
                        "order": 17,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1620,
                            "y": 600
                        },
                        "previous_function": "",
                        "previous_name": "set_status_add_note_3",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "warn",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 561
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "set status, add note",
                        "attrs": {
                            ".api": {
                                "text": "set status, add note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def set_status_add_note_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('set_status_add_note_2() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_prompt_timeout')\n\n    phantom.set_status(container=container, status=\"In progress\")\n\n    note_title = \"\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n    cf_local_Set_last_automated_action_2(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "key": "set-status",
                                "setStatusStatus": "In progress",
                                "setStatusStatus_display": "In progress"
                            },
                            {
                                "addNoteContent": "format_prompt_timeout:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ceb64779-4cb5-4d70-90a9-13652d1da1a5",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 417,
                        "line_start": 402,
                        "message": "Configuring now",
                        "name": "set status, add note",
                        "notes": "",
                        "number": 2,
                        "order": 16,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1620,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "set_status_add_note_2",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "warn",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 562
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "71a9a38a-2c95-4cf1-8053-3c55ceb3aa37",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6ac9c426-1a96-413d-b960-cd41dd94c857",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 567
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "96195cdc-ece1-4dae-aa09-ea009227ac71",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6ac9c426-1a96-413d-b960-cd41dd94c857",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0a5b8d3b-a40b-4a6c-9aa4-dadaf1cb976c",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 570
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6de91ef2-01d6-4396-aa12-40e6b4fabb91",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6ac9c426-1a96-413d-b960-cd41dd94c857",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b9f367bd-d66d-4250-85dd-67951a6dd65f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 573
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "set status",
                        "attrs": {
                            ".api": {
                                "text": "set status"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def set_status_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('set_status_1() called')\n\n    phantom.set_status(container=container, status=\"Open\")\n    filter_1(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "key": "set-status",
                                "setStatusStatus": "Open",
                                "setStatusStatus_display": "Open"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "6df0cb5a-092d-4a5e-979a-772ad69b0f5f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_set_status_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_set_status_1() called')\n\n    # check if all connected incoming playbooks, actions, or custom functions are done i.e. have succeeded or failed\n    if phantom.completed(playbook_names=['playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1', 'playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2']):\n        \n        # call connected block \"set_status_1\"\n        set_status_1(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 39,
                        "line_end": 50,
                        "line_start": 31,
                        "message": "Configuring now",
                        "name": "set status",
                        "notes": "",
                        "number": 1,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1460,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "set_status_1",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 574
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 7
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_7(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_7() called')\n    \n    status_param = container.get('status', None)\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [status_param, \"!=\", \"closed\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        playbook_local_PLAYBOOK_ENRICH_INDICATOR_ALL_01_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        playbook_local_PLAYBOOK_ENRICH_INDICATOR_VIRUSTOTAL_THREATSTREAM_01_2(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 2\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "KTB Triage Playbook for Generic Label",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "6ac9c426-1a96-413d-b960-cd41dd94c857",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 723,
                        "line_start": 700,
                        "name": "decision",
                        "notes": "",
                        "number": 7,
                        "order": 27,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "container:status",
                                        "value": "closed"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 980,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "decision_7",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 576
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".playbook": {
                                "text": "KTB Triage Playbook for ..."
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "Playbook"
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def playbook_local_KTB_Triage_Playbook_for_Generic_Label_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('playbook_local_KTB_Triage_Playbook_for_Generic_Label_1() called')\n    \n    # call playbook \"local/KTB Triage Playbook for Generic Label\", returns the playbook_run_id\n    playbook_run_id = phantom.playbook(playbook=\"local/KTB Triage Playbook for Generic Label\", container=container, name=\"playbook_local_KTB_Triage_Playbook_for_Generic_Label_1\", callback=decision_7)\n\n    return",
                        "callback_code": "",
                        "callback_start": 31,
                        "callsback": true,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "32eb334e-5b60-4d16-ae13-ecc5492d6dd3",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 31,
                        "line_start": 23,
                        "message": "Configuring now",
                        "name": "KTB Triage Playbook for Generic Label",
                        "notes": "",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "playbook": "local/KTB Triage Playbook for Generic Label",
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 720,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "playbook_local_KTB_Triage_Playbook_for_Generic_Label_1",
                        "scmName": "local",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "callplaybook",
                        "status": "",
                        "title": "Playbook",
                        "type": "coa.CallPlaybook",
                        "warn": false,
                        "z": 577
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "55395fca-21fb-422a-ae02-e123e05fd062",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cbc0cef9-e95b-477c-8c48-3d98b7f7e01c",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "da6af2b5-1177-4bf5-91fe-fdfc014769e8",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 578
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "transform url to send em..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def transform_url_to_send_email(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('transform_url_to_send_email() called')\n    \n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_1:condition_1:artifact:*.cef.requestURL'])\n    filtered_artifacts_item_1_0 = [item[0] for item in filtered_artifacts_data_1]\n\n    transform_url_to_send_email__transformURL = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    transformURL = []\n    for url in filtered_artifacts_item_1_0:\n        transformURL.append(url.replace(\".\",\"[dot]\"))\n    phantom.debug(\"transformURL = \")\n    phantom.debug(transformURL)\n    transform_url_to_send_email__transformURL = transformURL[0]\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='transform_url_to_send_email:transformURL', value=json.dumps(transform_url_to_send_email__transformURL))\n    format_14(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 11,
                        "custom_callback": "",
                        "custom_code": "def transform_url_to_send_email(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('transform_url_to_send_email() called')\n    \n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_1:condition_1:artifact:*.cef.requestURL'])\n    filtered_artifacts_item_1_0 = [item[0] for item in filtered_artifacts_data_1]\n\n    transform_url_to_send_email__transformURL = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    transformURL = []\n    for url in filtered_artifacts_item_1_0:\n        transformURL.append(url.replace(\".\",\"[dot]\"))\n    phantom.debug(\"transformURL = \")\n    phantom.debug(transformURL)\n    transform_url_to_send_email__transformURL = transformURL[0]\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='transform_url_to_send_email:transformURL', value=json.dumps(transform_url_to_send_email__transformURL))\n    format_14(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "transform url to send email",
                        "description": "",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "f59cbd29-9acc-452b-b5be-211b6047e04e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 561,
                        "legacy": true,
                        "line_end": 569,
                        "line_start": 540,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "",
                        "number": 7,
                        "order": 22,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "transformURL"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_1:artifact:*.cef.requestURL"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 420,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "transform_url_to_send_email",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    # Write your custom code here...\n    transformURL = []\n    for url in filtered_artifacts_item_1_0:\n        transformURL.append(url.replace(\".\",\"[dot]\"))\n    phantom.debug(\"transformURL = \")\n    phantom.debug(transformURL)\n    transform_url_to_send_email__transformURL = transformURL[0]\n\n",
                        "warn": false,
                        "z": 592
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 5
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_5(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_5() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.requestURL\", \"!=\", \"\"],\n            [\"artifact:*.cef.destinationDnsDomain\", \"==\", \"\"],\n        ],\n        logical_operator='and')\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        extract_domain(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # check for 'elif' condition 2\n    matched = phantom.decision(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.requestURL\", \"!=\", \"\"],\n        ])\n\n    # call connected blocks if condition 2 matched\n    if matched:\n        join_update_proxy_url(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": false,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0ffc1921-ad65-4636-a943-b2a7a6e0fe59",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 200,
                        "line_start": 169,
                        "name": "decision",
                        "notes": "",
                        "number": 5,
                        "order": 8,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.destinationDnsDomain",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL",
                                        "value": ""
                                    }
                                ],
                                "display": "Else If",
                                "logic": "and",
                                "type": "elif"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 120,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "decision_5",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 593
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bc928388-199f-463c-a3ca-00729ab3144e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0ffc1921-ad65-4636-a943-b2a7a6e0fe59",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4783dfd1-7aab-4a4d-a214-76638cf74e7d",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 595
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "720e7d65-5587-4db9-98ec-d2f8d0549202",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "da6af2b5-1177-4bf5-91fe-fdfc014769e8",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c407b1a2-956c-4b1a-804c-fe7212e50ff6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 596
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "fmt block url successful"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def fmt_block_url_successful(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('fmt_block_url_successful() called')\n    \n    template = \"\"\"This is an automated message to inform you of the containment is success.\n\nCase Name: {0}\nContained URL: {1}\nContain Status: {2}\n\nPlease do not respond to this message.\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"container:name\",\n        \"artifact:*.cef.requestURL\",\n        \"artifact:*.cef.requestURL_ContainResult\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"fmt_block_url_successful\", separator=\", \")\n\n    add_note_set_status_promote_to_case_6(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "fmt block url successful",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c407b1a2-956c-4b1a-804c-fe7212e50ff6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 755,
                        "line_start": 731,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 15,
                        "order": 29,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "container:name"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "artifact:*.cef.requestURL"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "artifact:*.cef.requestURL_ContainResult"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1640,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "fmt_block_url_successful",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "warn",
                        "template": "This is an automated message to inform you of the containment is success.\n\nCase Name: {0}\nContained URL: {1}\nContain Status: {2}\n\nPlease do not respond to this message.",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 598
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "add note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def add_note_5(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_note_5() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_14')\n\n    note_title = \"\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n    join_cf_local_Set_last_automated_action_3(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "format_14:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "e8d0ae4a-dd42-48e2-9947-284ee05d781e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 607,
                        "line_start": 594,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "",
                        "number": 5,
                        "order": 24,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1040,
                            "y": 880
                        },
                        "previous_function": "",
                        "previous_name": "add_note_5",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 599
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bbda6c8c-f882-41a1-bfc0-7c3014bbc498",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c407b1a2-956c-4b1a-804c-fe7212e50ff6",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "692a5677-9e85-4102-b41b-1766a2584f60",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 600
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note, set status, promote to-case",
                        "attrs": {
                            ".api": {
                                "text": "add note, set status, pro..."
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def add_note_set_status_promote_to_case_6(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_note_set_status_promote_to_case_6() called')\n\n    formatted_data_1 = phantom.get_format_data(name='fmt_block_url_successful')\n\n    note_title = \"\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n\n    phantom.set_status(container=container, status=\"Resolved\")\n\n    phantom.promote(container=container, template=\"KTB Workbook\")\n    cf_local_Set_last_automated_action_4(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "fmt_block_url_successful:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "",
                                "key": "add-note"
                            },
                            {
                                "key": "set-status",
                                "setStatusStatus": "Resolved",
                                "setStatusStatus_display": "Resolved"
                            },
                            {
                                "key": "promote-to-case",
                                "promoteToCaseTemplate": "KTB Workbook",
                                "promoteToCaseTemplate_display": "KTB Workbook"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "692a5677-9e85-4102-b41b-1766a2584f60",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 772,
                        "line_start": 755,
                        "message": "Configuring now",
                        "name": "add note, set status, promote to-case",
                        "notes": "",
                        "number": 6,
                        "order": 30,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1860,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "add_note_set_status_promote_to_case_6",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "warn",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 601
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "4b633958-70ac-47ef-b6af-6df492cacded",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "692a5677-9e85-4102-b41b-1766a2584f60",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9150c066-9be9-40d4-b2a9-ac06164bc452",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 602
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format contain url"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_contain_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_contain_url() called')\n    \n    template = \"\"\"Dear Approver,\n   This is an automated message to inform you of the containment approval request in phantom.\n   According to the case and details below, please attend Phantom to approve the containment accordingly.\n\n====================\n[Case ID]: {0}\n[Case Name]: {1}\n[IOC to contain]: {2}\n[Security device to contain]: Fortigate URL\n[Link to Phantom Event]: https://phantom.csoc.krungthai.local/mission/{0}\n[Case details]: {3}\n====================\n\nPlease do not respond to this message.\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"container:id\",\n        \"container:name\",\n        \"transform_url_to_send_email:custom_function:transformURL\",\n        \"filtered-data:filter_1:condition_1:artifact:*.name\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_contain_url\", separator=\", \")\n\n    send_email_2(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format contain url",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "06f07614-3521-4bd8-b841-5655d33ff3d6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 267,
                        "line_start": 235,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 10,
                        "order": 10,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "container:id"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "container:name"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "transform_url_to_send_email:custom_function:transformURL"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_1:artifact:*.name"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 660,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "format_contain_url",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "warn",
                        "template": "Dear Approver,\n   This is an automated message to inform you of the containment approval request in phantom.\n   According to the case and details below, please attend Phantom to approve the containment accordingly.\n\n====================\n[Case ID]: {0}\n[Case Name]: {1}\n[IOC to contain]: {2}\n[Security device to contain]: Fortigate URL\n[Link to Phantom Event]: https://phantom.csoc.krungthai.local/mission/{0}\n[Case details]: {3}\n====================\n\nPlease do not respond to this message.",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 604
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "8beb7c36-ab70-4d5f-b058-fd2e0fc451e3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9150c066-9be9-40d4-b2a9-ac06164bc452",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1a118922-7301-4aaa-865c-f12f819569da",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 606
                    },
                    {
                        ".scmName/text": "local",
                        "Container_id-0": "container:id",
                        "a_status-1": "Resolved",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "Set_last_automated_acti..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_Set_last_automated_action_4(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_Set_last_automated_action_4() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n    literal_values_0 = [\n        [\n            \"Resolved\",\n        ],\n    ]\n\n    parameters = []\n\n    literal_values_0_0 = [item[0] for item in literal_values_0]\n    container_property_0_0 = [item[0] for item in container_property_0]\n\n    parameters.append({\n        'a_status': literal_values_0_0,\n        'Container_id': container_property_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/Set_last_automated_action\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/Set_last_automated_action', parameters=parameters, name='cf_local_Set_last_automated_action_4')\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/Set_last_automated_action",
                        "cfInputs": {
                            "Container_id": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            },
                            "a_status": {
                                "collectionType": "literal_values",
                                "dataPath": "Resolved",
                                "paramName": "literal_values_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 26,
                        "customFunction": "local/Set_last_automated_action",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9150c066-9be9-40d4-b2a9-ac06164bc452",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 810,
                        "line_start": 772,
                        "message": "Configuring now",
                        "name": "Set_last_automated_action",
                        "notes": "",
                        "number": 4,
                        "order": 31,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2080,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_Set_last_automated_action_4",
                        "selectedCustomFunction": {
                            "description": "set custom field last_automated_action",
                            "draftMode": false,
                            "id": 111,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [
                                        "phantom container id"
                                    ],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 205,
                                    "input_type": "list",
                                    "name": "Container_id",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 206,
                                    "input_type": "list",
                                    "name": "a_status",
                                    "placeholder": ""
                                }
                            ],
                            "name": "Set_last_automated_action",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "data_path": "res",
                                    "description": "",
                                    "id": 97
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/test update filed",
                                        "draft_mode": false,
                                        "id": 2171,
                                        "name": "test update filed",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/test-nploywon-External IP Blocking Playbook",
                                        "draft_mode": false,
                                        "id": 4656,
                                        "name": "test-nploywon-External IP Blocking Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/010-Triage playbook",
                                        "draft_mode": false,
                                        "id": 3358,
                                        "name": "010-Triage playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/022-Master Malware_backup",
                                        "draft_mode": false,
                                        "id": 3359,
                                        "name": "022-Master Malware_backup",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Triage Playbook for Generic Label",
                                        "draft_mode": false,
                                        "id": 4530,
                                        "name": "KTB Triage Playbook for Generic Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "draft_mode": false,
                                        "id": 4625,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-PROXY-01",
                                        "draft_mode": false,
                                        "id": 4626,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-PROXY-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Triage Playbook",
                                        "draft_mode": false,
                                        "id": 4539,
                                        "name": "KTB Triage Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/KTB -Triage Playbook for Events Label",
                                        "draft_mode": false,
                                        "id": 4540,
                                        "name": "KTB -Triage Playbook for Events Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "draft_mode": false,
                                        "id": 4627,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-DATA-01",
                                        "draft_mode": false,
                                        "id": 4628,
                                        "name": "PLAYBOOK-INVESTIGATE-DATA-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/01-Contain-Approve-Playbook",
                                        "draft_mode": false,
                                        "id": 4031,
                                        "name": "01-Contain-Approve-Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Approve Playbook",
                                        "draft_mode": false,
                                        "id": 4033,
                                        "name": "KTB Approve Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                                        "draft_mode": false,
                                        "id": 3620,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Malware Contain Playbook",
                                        "draft_mode": false,
                                        "id": 4050,
                                        "name": "KTB Malware Contain Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/02-Master Malware",
                                        "draft_mode": false,
                                        "id": 3435,
                                        "name": "02-Master Malware",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbook_recover_version_0503",
                                        "draft_mode": false,
                                        "id": 4061,
                                        "name": "KTB Master Playbook_recover_version_0503",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-EMAIL-01",
                                        "draft_mode": false,
                                        "id": 4501,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-EMAIL-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-ENRICH-EXTERNAL-IP",
                                        "draft_mode": false,
                                        "id": 4382,
                                        "name": "KTB-ENRICH-EXTERNAL-IP",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-ENRICH-EMAIL",
                                        "draft_mode": false,
                                        "id": 4470,
                                        "name": "KTB-ENRICH-EMAIL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbook",
                                        "draft_mode": false,
                                        "id": 4065,
                                        "name": "KTB Master Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "draft_mode": false,
                                        "id": 4082,
                                        "name": "PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbookbypass ",
                                        "draft_mode": false,
                                        "id": 4087,
                                        "name": "KTB Master Playbookbypass ",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-ENRICH-EMAIL-bak",
                                        "draft_mode": false,
                                        "id": 4449,
                                        "name": "KTB-ENRICH-EMAIL-bak",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB-CONTAIN-URL",
                                        "draft_mode": false,
                                        "id": 4095,
                                        "name": "KTB-CONTAIN-URL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/NPLOYWON-TEST-CHILD-MALWARE",
                                        "draft_mode": false,
                                        "id": 4711,
                                        "name": "NPLOYWON-TEST-CHILD-MALWARE",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/SERI-TEST-PLAYBOOK12-WEB",
                                        "draft_mode": false,
                                        "id": 4727,
                                        "name": "SERI-TEST-PLAYBOOK12-WEB",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/SERI-TEST-PLAYBOOK16-EXFIL",
                                        "draft_mode": false,
                                        "id": 4728,
                                        "name": "SERI-TEST-PLAYBOOK16-EXFIL",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "warn",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 607
                    },
                    {
                        ".scmName/text": "local",
                        "Container_id-0": "container:id",
                        "a_status-1": "Containment Approval Rejected",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "Set_last_automated_acti..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_Set_last_automated_action_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_Set_last_automated_action_1() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n    literal_values_0 = [\n        [\n            \"Containment Approval Rejected\",\n        ],\n    ]\n\n    parameters = []\n\n    literal_values_0_0 = [item[0] for item in literal_values_0]\n    container_property_0_0 = [item[0] for item in container_property_0]\n\n    parameters.append({\n        'a_status': literal_values_0_0,\n        'Container_id': container_property_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/Set_last_automated_action\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/Set_last_automated_action', parameters=parameters, name='cf_local_Set_last_automated_action_1')\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/Set_last_automated_action",
                        "cfInputs": {
                            "Container_id": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            },
                            "a_status": {
                                "collectionType": "literal_values",
                                "dataPath": "Containment Approval Rejected",
                                "paramName": "literal_values_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 26,
                        "customFunction": "local/Set_last_automated_action",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b71b40a3-55c3-450e-91f4-6d942f06f8c6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 470,
                        "line_start": 432,
                        "message": "Configuring now",
                        "name": "Set_last_automated_action",
                        "notes": "",
                        "number": 1,
                        "order": 18,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2080,
                            "y": 600
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_Set_last_automated_action_1",
                        "selectedCustomFunction": {
                            "description": "set custom field last_automated_action",
                            "draftMode": false,
                            "id": 111,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [
                                        "phantom container id"
                                    ],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 205,
                                    "input_type": "list",
                                    "name": "Container_id",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "description": "",
                                    "id": 206,
                                    "input_type": "list",
                                    "name": "a_status",
                                    "placeholder": ""
                                }
                            ],
                            "name": "Set_last_automated_action",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "Set_last_automated_action",
                                    "contains_type": [],
                                    "custom_function": 111,
                                    "data_path": "res",
                                    "description": "",
                                    "id": 97
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-ENRICH-INDICATOR-VIRTUSTOTAL-THREASTREAM-01",
                                        "draft_mode": false,
                                        "id": 3620,
                                        "name": "PLAYBOOK-ENRICH-INDICATOR-VIRTUSTOTAL-THREASTREAM-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "draft_mode": false,
                                        "id": 3611,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-SPLUNK-AD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": true,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "draft_mode": false,
                                        "id": 3632,
                                        "name": "PLAYBOOK-INVESTIGATE-ALERT-ATTIVO-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB -Triage Playbook for Attivo Label",
                                        "draft_mode": false,
                                        "id": 3167,
                                        "name": "KTB -Triage Playbook for Attivo Label",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/test update filed",
                                        "draft_mode": false,
                                        "id": 2171,
                                        "name": "test update filed",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/01-Contain-Approve-Playbook",
                                        "draft_mode": false,
                                        "id": 3148,
                                        "name": "01-Contain-Approve-Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/010-Triage playbook",
                                        "draft_mode": false,
                                        "id": 3358,
                                        "name": "010-Triage playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/022-Master Malware_backup",
                                        "draft_mode": false,
                                        "id": 3359,
                                        "name": "022-Master Malware_backup",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Triage Playbook",
                                        "draft_mode": false,
                                        "id": 3496,
                                        "name": "KTB Triage Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Approve Playbook",
                                        "draft_mode": false,
                                        "id": 3367,
                                        "name": "KTB Approve Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-INVESTIGATE-DATA-01",
                                        "draft_mode": false,
                                        "id": 3663,
                                        "name": "PLAYBOOK-INVESTIGATE-DATA-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTB Master Playbook",
                                        "draft_mode": false,
                                        "id": 3774,
                                        "name": "KTB Master Playbook",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "draft_mode": false,
                                        "id": 3684,
                                        "name": "PLAYBOOK-CONTAIN-INCIDENT-CLOUD-01",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/KTC-CONTAIN-URL",
                                        "draft_mode": false,
                                        "id": 3775,
                                        "name": "KTC-CONTAIN-URL",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/02-Master Malware",
                                        "draft_mode": false,
                                        "id": 3435,
                                        "name": "02-Master Malware",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "warn",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 608
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5fb2e67c-b5ce-41e8-b973-03af001bff33",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "f59cbd29-9acc-452b-b5be-211b6047e04e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "23fc3590-7495-4c41-8383-b086c73afe1f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 612
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 6
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-2": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": -2
                            },
                            ".outPorts>.port-2>.port-body": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_6(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_6() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Contain_URL_Confirmation:action_result.status\", \"==\", \"success\"],\n            [\"Contain_URL_Confirmation:action_result.summary.responses.0\", \"==\", \"Yes\"],\n        ],\n        logical_operator='and')\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        playbook_local_PLAYBOOK_CONTAIN_INDICATOR_FORTIGATEKTBCS_URL_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # check for 'elif' condition 2\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Contain_URL_Confirmation:action_result.status\", \"==\", \"success\"],\n            [\"Contain_URL_Confirmation:action_result.summary.responses.0\", \"==\", \"No\"],\n        ],\n        logical_operator='and')\n\n    # call connected blocks if condition 2 matched\n    if matched:\n        format_prompt_decline(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 3\n    format_prompt_timeout(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "cbc0cef9-e95b-477c-8c48-3d98b7f7e01c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 368,
                        "line_start": 330,
                        "name": "decision",
                        "notes": "",
                        "number": 6,
                        "order": 13,
                        "outPorts": [
                            "out-1",
                            "out-2",
                            "out-3"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Contain_URL_Confirmation:action_result.status",
                                        "value": "success"
                                    },
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Contain_URL_Confirmation:action_result.summary.responses.0",
                                        "value": "Yes"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Contain_URL_Confirmation:action_result.status",
                                        "value": "success"
                                    },
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Contain_URL_Confirmation:action_result.summary.responses.0",
                                        "value": "No"
                                    }
                                ],
                                "display": "Else If",
                                "logic": "and",
                                "type": "elif"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1160,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "decision_6",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "warn",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 613
                    },
                    {
                        "action": "send email",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attachments": "",
                            "bcc": "",
                            "body": "format_contain_url:formatted_data",
                            "cc": "",
                            "from": "no-reply-phantom@ktbcs.co.th",
                            "headers": "",
                            "subject": "SOAR - Containment Approval Needed - Notification",
                            "to": "security-infra@ktbcs.co.th"
                        },
                        "angle": 0,
                        "app": "SMTP",
                        "appid": "45bb6f37-4478-499b-b4a3-51ecfa62b78c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "send email",
                                "actions": [
                                    "send htmlemail",
                                    "send rawemail",
                                    "send email",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "SMTP",
                                "app_version": "2.1.3",
                                "appid": "45bb6f37-4478-499b-b4a3-51ecfa62b78c",
                                "asset_name": "smtp asset",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "attachments": "",
                                    "bcc": "",
                                    "body": "format_contain_url:formatted_data",
                                    "cc": "",
                                    "from": "no-reply-phantom@ktbcs.co.th",
                                    "headers": "",
                                    "subject": "SOAR - Containment Approval Needed - Notification",
                                    "to": "security-infra@ktbcs.co.th"
                                },
                                "has_app": true,
                                "id": 6,
                                "loaded": false,
                                "missing": false,
                                "name": "smtp asset",
                                "output": [
                                    {
                                        "column_name": "Status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.attachments",
                                        "data_type": "string",
                                        "example_values": [
                                            "ab2b2ccfba08ea538ef22f521caa01c3c2b17ccf"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.bcc",
                                        "data_type": "string",
                                        "example_values": [
                                            "test1@testdomain.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string",
                                        "example_values": [
                                            "Test body"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.cc",
                                        "data_type": "string",
                                        "example_values": [
                                            "test2@testdomain.com"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string",
                                        "example_values": [
                                            "sender@testdomain.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.headers",
                                        "data_type": "string",
                                        "example_values": [
                                            "{\"Subject\": \"Test1\", \"To\": \"test3@testdomain.com\"}"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string",
                                        "example_values": [
                                            "Test"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string",
                                        "example_values": [
                                            "receiver@testdomain.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Email sent"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "attachments": {
                                        "allow_list": true,
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Vault IDs of files to attach",
                                        "key": "attachments",
                                        "order": 6,
                                        "primary": true,
                                        "required": false
                                    },
                                    "bcc": {
                                        "allow_list": true,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "List of recipients email addresses to include on bcc line",
                                        "key": "bcc",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "body": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message body",
                                        "key": "body",
                                        "order": 5,
                                        "required": true
                                    },
                                    "cc": {
                                        "allow_list": true,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "List of recipients email addresses to include on cc line",
                                        "key": "cc",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "from": {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "From field",
                                        "key": "from",
                                        "order": 0,
                                        "primary": true,
                                        "required": false
                                    },
                                    "headers": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Custom email headers (formatted as JSON)",
                                        "key": "headers",
                                        "order": 7,
                                        "required": false
                                    },
                                    "subject": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Message Subject",
                                        "key": "subject",
                                        "order": 4,
                                        "required": false
                                    },
                                    "to": {
                                        "allow_list": true,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "List of recipients email addresses",
                                        "key": "to",
                                        "order": 1,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "SMTP",
                                "product_vendor": "Generic",
                                "targets": "6",
                                "type": "email"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "send email"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def send_email_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('send_email_2() called')\n\n    # collect data for 'send_email_2' call\n    formatted_data_1 = phantom.get_format_data(name='format_contain_url')\n\n    parameters = []\n    \n    # build parameters list for 'send_email_2' call\n    parameters.append({\n        'cc': \"\",\n        'to': \"security-infra@ktbcs.co.th\",\n        'bcc': \"\",\n        'body': formatted_data_1,\n        'from': \"no-reply-phantom@ktbcs.co.th\",\n        'headers': \"\",\n        'subject': \"SOAR - Containment Approval Needed - Notification\",\n        'attachments': \"\",\n    })\n\n    phantom.act(action=\"send email\", parameters=parameters, assets=['smtp asset'], callback=Contain_URL_Confirmation, name=\"send_email_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": false,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c26f671b-315e-4b67-b42d-7a333cfb0085",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 291,
                        "line_start": 267,
                        "message": "Configuring now",
                        "name": "send email",
                        "notes": "",
                        "number": 2,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 660,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "send_email_2",
                        "required_params": {
                            "body": true,
                            "to": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 614
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".playbook": {
                                "text": "PLAYBOOK-CONTAIN-IN..."
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "Playbook"
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def playbook_local_PLAYBOOK_CONTAIN_INDICATOR_FORTIGATEKTBCS_URL_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('playbook_local_PLAYBOOK_CONTAIN_INDICATOR_FORTIGATEKTBCS_URL_1() called')\n    \n    # call playbook \"local/PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL\", returns the playbook_run_id\n    playbook_run_id = phantom.playbook(playbook=\"local/PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL\", container=container, name=\"playbook_local_PLAYBOOK_CONTAIN_INDICATOR_FORTIGATEKTBCS_URL_1\", callback=fmt_block_url_successful)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "connected_to_start": false,
                        "connection_name": "Contain URL Confirmation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "da6af2b5-1177-4bf5-91fe-fdfc014769e8",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 731,
                        "line_start": 723,
                        "message": "Configuring now",
                        "name": "PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL",
                        "notes": "",
                        "number": 1,
                        "order": 28,
                        "outPorts": [
                            "out"
                        ],
                        "playbook": "local/PLAYBOOK-CONTAIN-INDICATOR-FORTIGATEKTBCS-URL",
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1360,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "playbook_local_PLAYBOOK_CONTAIN_INDICATOR_FORTIGATEKTBCS_URL_1",
                        "scmName": "local",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "callplaybook",
                        "status": "warn",
                        "title": "Playbook",
                        "type": "coa.CallPlaybook",
                        "warn": false,
                        "z": 615
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def filter_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_1() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.requestURL_malicious\", \"==\", True],\n            [\"artifact:*.cef.requestURL\", \"not in\", \"custom_list:noContainUrl\"],\n        ],\n        logical_operator='and',\n        name=\"filter_1:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        transform_url_to_send_email(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.requestURL_malicious\", \"==\", True],\n            [\"artifact:*.cef.requestURL\", \"in\", \"custom_list:noContainUrl\"],\n        ],\n        logical_operator='and',\n        name=\"filter_1:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        format_URL_in_no_contain_list(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "PLAYBOOK-ENRICH-INDICATOR-VIRUSTOTAL-THREATSTREAM-01, PLAYBOOK-ENRICH-INDICATOR-ALL-01",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d4a878a7-94dd-4e9d-8325-8ad69f5f836b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 225,
                        "line_end": 235,
                        "line_start": 200,
                        "name": "filter",
                        "notes": "",
                        "number": 1,
                        "order": 9,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL_malicious",
                                        "value": "True"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL",
                                        "value": "custom_list:noContainUrl"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL_malicious",
                                        "value": "True"
                                    },
                                    {
                                        "comparison": "in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.requestURL",
                                        "value": "custom_list:noContainUrl"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 280,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "filter_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 616
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "approver": "Tier2 Analyst",
                        "approver_display": "Tier2 Analyst",
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Contain_URL_Confirmation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('Contain_URL_Confirmation() called')\n    \n    # set user and message variables for phantom.prompt call\n    user = \"Tier2 Analyst\"\n    message = \"\"\"***WARNING*** \nDo you want to proceed with containment for Request URL = {0}?\n\nEvent Info:\nCase ID: {1}\nCase Name: {2}\n\nSend from playbook: PLAYBOOK-INVESTIGATE-ALERT-PROXY-01\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_1:condition_1:artifact:*.cef.requestURL\",\n        \"container:id\",\n        \"container:name\",\n    ]\n\n    #responses:\n    response_types = [\n        {\n            \"prompt\": \"\",\n            \"options\": {\n                \"type\": \"list\",\n                \"choices\": [\n                    \"Yes\",\n                    \"No\",\n                ]\n            },\n        },\n    ]\n\n    phantom.prompt2(container=container, user=user, message=message, respond_in_mins=30, name=\"Contain_URL_Confirmation\", separator=\", \", parameters=parameters, response_types=response_types, callback=decision_6)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "connected_to_start": false,
                        "connection_name": "send email",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Contain URL Confirmation",
                        "delimiter": ", ",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d40674a8-f604-4eeb-877c-41b908060a59",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 330,
                        "line_start": 291,
                        "message": "***WARNING*** \nDo you want to proceed with containment for Request URL = {0}?\n\nEvent Info:\nCase ID: {1}\nCase Name: {2}\n\nSend from playbook: PLAYBOOK-INVESTIGATE-ALERT-PROXY-01",
                        "name": "prompt",
                        "notes": "",
                        "number": 1,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_1:condition_1:artifact:*.cef.requestURL"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "container:id"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "container:name"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1000,
                            "y": 480
                        },
                        "previous_function": "",
                        "previous_name": "Contain_URL_Confirmation",
                        "respond_in": "30",
                        "response_key": "Message",
                        "response_options": [],
                        "response_type": "list",
                        "responses": [
                            {
                                "response_key": "Yes/No",
                                "response_options": [
                                    "Yes",
                                    "No"
                                ],
                                "response_prompt": "",
                                "response_type": "list"
                            }
                        ],
                        "show_number": true,
                        "size": {
                            "height": 80,
                            "width": 80
                        },
                        "state": "prompt",
                        "status": "warn",
                        "type": "coa.Prompt",
                        "warn": false,
                        "z": 617
                    }
                ]
            },
            "notes": ""
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.7.63984"
    },
    "create_time": "2022-10-05T03:43:12.642147+00:00",
    "draft_mode": false,
    "labels": [
        "web"
    ],
    "tags": []
}